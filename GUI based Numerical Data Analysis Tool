import tkinter as tk
from tkinter import filedialog, messagebox
import pandas as pd
import numpy as np

root = tk.Tk()
root.title("GUI Based Numerical Data Analysis Tool")
root.geometry("650x650")
root.resizable(True,True)

tk.Label(
    root,
    text="Numerical Data Analysis Tool",
    font=("Arial", 18, "bold"),
    fg="blue"
).pack(pady=10)

tk.Label(
    root,
    text="Enter numbers separated by space OR load CSV file",
    font=("Arial", 11)
).pack()

entry = tk.Entry(root, width=50, font=("Arial", 12))
entry.pack(pady=10)

result = tk.Text(root, height=18, width=75, font=("Arial", 10))5522
result.pack(pady=10)

data_series = None

def get_data_from_entry():
    global data_series
    try:
        values = list(map(float, entry.get().split()))
        data_series = pd.Series(values)
        return data_series
    except:
        messagebox.showerror("Error", "Please enter valid numeric values")
        return None

def load_csv():
    global data_series
    file_path = filedialog.askopenfilename(
        filetypes=[("CSV Files", "*.csv")]
    )
    if file_path:
        try:
            df = pd.read_csv(file_path)
            data_series = df.iloc[:, 0]
            entry.delete(0, tk.END)
            entry.insert(0, "Data loaded from CSV file")
            messagebox.showinfo("Success", "CSV File Loaded Successfully")
        except:
            messagebox.showerror("Error", "Invalid CSV file")

def show_properties():
    data = data_series if data_series is not None else get_data_from_entry()
    if data is not None:
        result.delete("1.0", tk.END)
        result.insert(tk.END, "# Properties of the array\n")
        result.insert(tk.END, f"{data.shape}\n")
        result.insert(tk.END, f"{data.ndim}\n")
        result.insert(tk.END, f"{data.size}\n")
        result.insert(tk.END, f"{data.dtype}\n")
        result.insert(tk.END, f"{data.itemsize}\n")
        result.insert(tk.END, f"{data.nbytes}\n")
        result.insert(tk.END, f"{data.T}\n")

def show_statistics():
    data = data_series if data_series is not None else get_data_from_entry()
    if data is not None:
        result.delete("1.0", tk.END)
        result.insert(tk.END, "### STATISTICAL ANALYSIS ###\n\n")
        result.insert(tk.END, f"{data.sum()}\n")
        result.insert(tk.END, f"{data.mean()}\n")
        result.insert(tk.END, f"{data.max()}\n")
        result.insert(tk.END, f"{data.min()}\n")
        result.insert(tk.END, f"{data.std()}\n")
        result.insert(tk.END, f"{data.var()}\n")

def show_math_operations():
    data = data_series if data_series is not None else get_data_from_entry()
    if data is not None:
        result.delete("1.0", tk.END)
        result.insert(tk.END, "# Mathematical Operations\n\n")
        result.insert(tk.END, f"{np.square(data.values)}\n\n")
        result.insert(tk.END, f"{np.sqrt(np.abs(data.values))}\n\n")
        result.insert(tk.END, f"{data.values + 10}\n\n")
        result.insert(tk.END, f"{data.values * 2}\n")


def clear_all():
    global data_series
    data_series = None
    entry.delete(0, tk.END)
    result.delete("1.0", tk.END)


btn_frame = tk.Frame(root)
btn_frame.pack(pady=10)

tk.Button(btn_frame, text="Load CSV", width=18, command=load_csv).grid(row=0, column=0, padx=5, pady=5)
tk.Button(btn_frame, text="Data Properties", width=18, command=show_properties).grid(row=0, column=1, padx=5, pady=5)
tk.Button(btn_frame, text="Statistics", width=18, command=show_statistics).grid(row=1, column=0, padx=5, pady=5)
tk.Button(btn_frame, text="Math Operations", width=18, command=show_math_operations).grid(row=1, column=1, padx=5, pady=5)
tk.Button(btn_frame, text="Clear", width=18, command=clear_all).grid(row=2, column=0, columnspan=2, pady=5)

tk.Label(
    root,
    text="Developed by Shailav Singh | Python • Pandas • NumPy • Tkinter",
    font=("Arial", 9)
).pack(side="bottom", pady=10)

root.mainloop()
